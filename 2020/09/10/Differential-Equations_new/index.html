<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Differential-Equations | M@tr1xの日常</title><meta name="description" content="非刚性常微分方程形如类的方程,反求出 y 的值,并最终画出原函数图像 ode23 – 求解非刚性微分方程 - 低阶方法语法[t,y] &#x3D; ode23(odefun,tspan,y0)[t,y] &#x3D; ode23(odefun,tspan,y0,options)[t,y,te,ye,ie] &#x3D; ode23(odefun,tspan,y0,options)sol &#x3D; ode23(___) 说明[t,"><meta name="keywords" content="微分方程"><meta name="author" content="M@tr1x"><meta name="copyright" content="M@tr1x"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.blog.hackerjerry.top/2020/09/10/Differential-Equations_new/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="UA-157542666-1"/><meta property="og:type" content="article"><meta property="og:title" content="Differential-Equations"><meta property="og:url" content="https://www.blog.hackerjerry.top/2020/09/10/Differential-Equations_new/"><meta property="og:site_name" content="M@tr1xの日常"><meta property="og:description" content="非刚性常微分方程形如类的方程,反求出 y 的值,并最终画出原函数图像 ode23 – 求解非刚性微分方程 - 低阶方法语法[t,y] &#x3D; ode23(odefun,tspan,y0)[t,y] &#x3D; ode23(odefun,tspan,y0,options)[t,y,te,ye,ie] &#x3D; ode23(odefun,tspan,y0,options)sol &#x3D; ode23(___) 说明[t,"><meta property="og:image" content="https://image.hackerjerry.top/wallpaper-8.jpg"><meta property="article:published_time" content="2020-09-10T09:04:08.000Z"><meta property="article:modified_time" content="2021-08-21T08:58:41.846Z"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime: '天',
  last_push_date: {"zeroDay":"今天","suffix":"天前"},
  copyright: {"limitCount":50,"languages":{"author":"作者: M@tr1x","link":"链接: ","source":"来源: M@tr1xの日常","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
      const now = new Date()
      const expiryDay = ttl * 86400000
      const item = {
        value: value,
        expiry: now.getTime() + expiryDay,
      }
      localStorage.setItem(key, JSON.stringify(item))
    },
  
  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2021-08-21 16:58:41'
}</script><noscript><style type="text/css">
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="M@tr1xの日常" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">77</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">45</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/bangumis/"><i class="fa-fw fa fa-film"></i><span> 追番</span></a></li><li><a class="site-page" href="/artalk/"><i class="fa-fw fa-fw fa fa-comment-alt"></i><span> 说说</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E5%88%9A%E6%80%A7%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">非刚性常微分方程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ode23-%E2%80%93-%E6%B1%82%E8%A7%A3%E9%9D%9E%E5%88%9A%E6%80%A7%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B-%E4%BD%8E%E9%98%B6%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">ode23 – 求解非刚性微分方程 - 低阶方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-number">1.1.2.</span> <span class="toc-text">说明</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E4%BA%8C%E9%98%B6%E9%9D%9E%E5%88%9A%E6%80%A7-ODE-%E6%96%B9%E7%A8%8B"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">对于二阶非刚性 ODE 方程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%A0%E5%85%A5%E9%A2%9D%E5%A4%96%E5%8F%82%E6%95%B0"><span class="toc-number">1.1.2.1.1.</span> <span class="toc-text">传入额外参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.3.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ode45-%E2%80%93-%E6%B1%82%E8%A7%A3%E9%9D%9E%E5%88%9A%E6%80%A7%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B-%E4%B8%AD%E9%98%B6%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">ode45 – 求解非刚性微分方程 - 中阶方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">语法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9A%E6%80%A7%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">刚性常微分方程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB"><span class="toc-number">2.1.</span> <span class="toc-text">区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A3%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E7%AC%A6%E5%8F%B7%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">解常微分方程符号解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E7%9A%84%E9%80%9A%E8%A7%A3"><span class="toc-number">3.1.</span> <span class="toc-text">求解常微分方程的通解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E7%9A%84%E5%88%9D%E8%BE%B9%E5%80%BC%E9%97%AE%E9%A2%98"><span class="toc-number">3.2.</span> <span class="toc-text">求解常微分方程的初边值问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-number">3.3.</span> <span class="toc-text">求解常微分方程组</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E5%AD%A6%E4%B9%A0"><span class="toc-number">4.</span> <span class="toc-text">实战学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E5%8F%98%E9%87%8F%E5%88%9D%E5%A7%8B%E5%80%BC%E4%B8%8B%E7%9A%84%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="toc-number">4.1.</span> <span class="toc-text">双变量初始值下的常微分方程组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%8F%E5%B0%94%E6%B3%B0%E6%8B%89-Volterra-%E5%BC%B1%E8%82%89%E5%BC%BA%E9%A3%9F%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.1.1.</span> <span class="toc-text">伏尔泰拉(Volterra)弱肉强食模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E6%8F%90%E5%87%BA"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">问题提出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">问题解决</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%81%AB%E7%AE%AD%E5%8D%87%E7%A9%BA%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.2.</span> <span class="toc-text">火箭升空模型</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://image.hackerjerry.top/wallpaper-8.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">M@tr1xの日常</a></span><span class="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/bangumis/"><i class="fa-fw fa fa-film"></i><span> 追番</span></a></li><li><a class="site-page" href="/artalk/"><i class="fa-fw fa-fw fa fa-comment-alt"></i><span> 说说</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Differential-Equations</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-09-10T09:04:08.000Z" title="发表于 2020-09-10 17:04:08">2020-09-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-08-21T08:58:41.846Z" title="更新于 2021-08-21 16:58:41">2021-08-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E5%AD%A6%E5%BB%BA%E6%A8%A1/">数学建模</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><a id="more"></a>

<h1 id="非刚性常微分方程"><a href="#非刚性常微分方程" class="headerlink" title="非刚性常微分方程"></a>非刚性常微分方程</h1><p>形如类的方程,反求出 y 的值,并最终画出原函数图像</p>
<h2 id="ode23-–-求解非刚性微分方程-低阶方法"><a href="#ode23-–-求解非刚性微分方程-低阶方法" class="headerlink" title="ode23 – 求解非刚性微分方程 - 低阶方法"></a>ode23 – 求解非刚性微分方程 - 低阶方法</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p><code>[t,y] = ode23(odefun,tspan,y0)</code><br><code>[t,y] = ode23(odefun,tspan,y0,options)</code><br><code>[t,y,te,ye,ie] = ode23(odefun,tspan,y0,options)</code><br><code>sol = ode23(___)</code></p>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p><code>[t,y] = ode23(odefun,tspan,y0)</code>（其中 tspan = [t0 tf]）求微分方程组 从 到 的积分，初始条件为 。<strong>解数组 中的每一行都与列向量 中返回的值相对应。</strong>,必须返回矩阵才能一一对应!<br><strong>参数</strong><code>odefun</code><br><strong>要求解的函数，指定为指向待积分函数的句柄。</strong><br>对于标量 t 和列向量 y 来说，函数 dydt = odefun(t,y) 必须返回数据类型为 single 或 double 的列向量 dydt，该列向量对应于 f(t,y)。odefun 必须同时接受输入参数 t 和 y，即使其中一个参数未在函数中使用也是如此。<br>例如，要解算 y′=5y−3，请使用此函数：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dydt</span> = <span class="title">odefun</span><span class="params">(t,y)</span></span></span><br><span class="line">dydt = <span class="number">5</span>*y<span class="number">-3</span>;</span><br></pre></td></tr></table></figure>

<p>对于方程组，odefun 的输出为向量。向量中的每个元素是一个方程的解。例如，要求解<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-1.svg#card=math&code=y%E2%80%B2_1%3Dy_1%2B2y_2%0A%0A&height=18&width=103"><br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-2.svg#card=math&code=y%E2%80%B2_2%3D3y_1%2B2y_2&height=18&width=112"></p>
<p>使用函数：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dydt</span> = <span class="title">odefun</span><span class="params">(t,y)</span></span></span><br><span class="line">dydt = <span class="built_in">zeros</span>(<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">dydt(<span class="number">1</span>) = y(<span class="number">1</span>)+<span class="number">2</span>*y(<span class="number">2</span>);</span><br><span class="line">dydt(<span class="number">2</span>) = <span class="number">3</span>*y(<span class="number">1</span>)+<span class="number">2</span>*y(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<div class="note important"><p>tspan</p>
</div>
<p><strong>积分区间，指定为向量。</strong>tspan 必须至少是一个二元素向量 [t0 tf]，用于指定初始时间和最终时间。要获取 t0 到 tf 之间的特定时间的解，请使用 [t0,t1,t2,…,tf] 形式的长向量。tspan 中的元素必须单调递增或单调递减。<br>求解器在初始时间 tspan(1) 施加由 y0 给出的初始条件，然后求 tspan(1) 到 tspan(end) 的积分：<br>如果 tspan 有两个元素，[t0 tf]，求解器将返回在该区间内的每个内部积分步计算的解。<br>如果 tspan 包含两个以上的元素，[t0,t1,t2,…,tf]，求解器将返回在给定点处计算的解。但是，求解器不会精确步进到 tspan 中指定的每个点。此时，求解器使用自己的内部积分步来计算解，然后在 tspan 中请求的各点处计算解。在指定点处生成的解与在每个内部积分步计算的解具有相同的准确度级别。示例</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-3.png#align=left&display=inline&height=279&margin=%5Bobject%20Object%5D&originHeight=279&originWidth=801&size=0&status=done&style=none&width=801"></p>
<h4 id="对于二阶非刚性-ODE-方程"><a href="#对于二阶非刚性-ODE-方程" class="headerlink" title="对于二阶非刚性 ODE 方程"></a>对于二阶非刚性 ODE 方程</h4><p>如$y_1’’- (1-y_1^2)*y_1’+y_1=0$,这是一个<code>van der Pol </code>方程.<br>二阶方程做一阶变换<br>令$y_2=y_1’$,因此$y_2’=(1-y_1^2)*y_2+y_1$<br>类似的对应关系<img src= "/img/loading.gif" data-lazy-src="https://cdn.nlark.com/yuque/0/2020/png/1629942/1599728724217-10c4acb3-9586-46a1-a955-b4fbc0909460.png#align=left&display=inline&height=346&margin=%5Bobject%20Object%5D&originHeight=346&originWidth=744&size=0&status=done&style=none&width=744"><br>具体 matlab 实现</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%vdp1.m文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dydt</span> = <span class="title">vdp1</span><span class="params">(t,y)</span></span></span><br><span class="line">dydt = [y(<span class="number">2</span>); (<span class="number">1</span>-y(<span class="number">1</span>)^<span class="number">2</span>)*y(<span class="number">2</span>)-y(<span class="number">1</span>)];<span class="comment">%将方程两边作为二维矩阵的两个行向量</span></span><br></pre></td></tr></table></figure>

<p>使用 ode23 函数、时间区间 [0 20] 和初始值 [2 ; 0]来解算该 ODE。生成的输出即为时间点 t 的列向量和解数组 y。y 中的每一行都与 t 的相应行中返回的时间相对应。y 的第一列与 相对应，第二列与 相对应。</p>
<blockquote>
<p>虽然初始值是上下排列,但最后得到的数据是左右排列(一列是对应一个 y,感觉好像转置了)</p>
</blockquote>
<p>调用文件</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[t,y] = ode23(@vdp1,[<span class="number">0</span> <span class="number">20</span>],[<span class="number">2</span>; <span class="number">0</span>]);<span class="comment">%使用@文件名可以调用里面的函数(最好文件名和函数名一致)</span></span><br><span class="line"><span class="built_in">plot</span>(t,y(:,<span class="number">1</span>),<span class="string">&#x27;-o&#x27;</span>,t,y(:,<span class="number">2</span>),<span class="string">&#x27;-o&#x27;</span>)<span class="comment">%绘制y1和y2的解图</span></span><br><span class="line">title(<span class="string">&#x27;Solution of van der Pol Equation (\mu = 1) with ODE23&#x27;</span>);</span><br><span class="line">xlabel(<span class="string">&#x27;Time t&#x27;</span>);</span><br><span class="line">ylabel(<span class="string">&#x27;Solution y&#x27;</span>);</span><br><span class="line"><span class="built_in">legend</span>(<span class="string">&#x27;y_1&#x27;</span>,<span class="string">&#x27;y_2&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong><br><code>ode23 </code>仅适用于使用两个输入参数（t 和 y）的函数。但是，通过在函数外部定义参数并在指定函数句柄时传递这些参数，可以传入额外参数。</p>
<h5 id="传入额外参数"><a href="#传入额外参数" class="headerlink" title="传入额外参数"></a>传入额外参数</h5><p>解$y’’=\frac{A}{B}ty$<br>重写令$y_1’=y_2$,因此$y_2’=\frac{A}{B}ty_1$<br>函数文件</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dydt</span> = <span class="title">odefun</span><span class="params">(t,y,a,b)</span></span></span><br><span class="line">dydt = [y(<span class="number">2</span>);(a/b)*t.*y(<span class="number">1</span>)]</span><br></pre></td></tr></table></figure>

<p>调用文件</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">A = <span class="number">1</span>;</span><br><span class="line">B = <span class="number">2</span>;</span><br><span class="line">tspan = [<span class="number">0</span> <span class="number">5</span>];</span><br><span class="line">y0 = [<span class="number">0</span>;<span class="number">0.01</span>];</span><br><span class="line">[t,y] = ode23(@(t,y) odefun(t,y,A,B), tspan, y0);</span><br><span class="line"><span class="built_in">plot</span>(t,y(:,<span class="number">1</span>),<span class="string">&#x27;-o&#x27;</span>,t,y(:,<span class="number">2</span>),<span class="string">&#x27;-.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>或者一个文件试了一下也是可以的</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">odefun = @(t,y,a,b)[y(<span class="number">2</span>);(a/b)*t.*y(<span class="number">1</span>)];</span><br><span class="line">A = <span class="number">1</span>;</span><br><span class="line">B = <span class="number">2</span>;</span><br><span class="line">tspan = [<span class="number">0</span> <span class="number">5</span>];</span><br><span class="line">y0 = [<span class="number">0</span>;<span class="number">0.01</span>];</span><br><span class="line">[t,y] = ode23(@(t,y) odefun(t,y,A,B), tspan, y0);</span><br><span class="line"><span class="built_in">plot</span>(t,y(:,<span class="number">1</span>),<span class="string">&#x27;-o&#x27;</span>,t,y(:,<span class="number">2</span>),<span class="string">&#x27;-.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-4.png#align=left&display=inline&height=411&margin=%5Bobject%20Object%5D&originHeight=411&originWidth=546&size=0&status=done&style=none&width=546"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><code>ode23</code> 是<code> Bogacki</code> 和 <code>Shampine </code>的显式 <code>Runge-Kutta (2,3)</code> 对的实现。在容差较宽松且刚度适中的情况下，它可能比 <code>ode45</code> 更加有效。<code>ode23 </code>是单步求解器</p>
<h2 id="ode45-–-求解非刚性微分方程-中阶方法"><a href="#ode45-–-求解非刚性微分方程-中阶方法" class="headerlink" title="ode45 – 求解非刚性微分方程 - 中阶方法"></a>ode45 – 求解非刚性微分方程 - 中阶方法</h2><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><p><code>[t,y] = ode45(odefun,tspan,y0)</code><br><code>[t,y] = ode45(odefun,tspan,y0,options)</code><br><code>[t,y,te,ye,ie] = ode45(odefun,tspan,y0,options)</code><br><code>sol = ode45(___)</code><br><strong>ode45 是一个通用型 ODE 求解器，是解算大多数问题时的首选。但是，对于刚性问题或需要较高准确性的问题，其他 ODE 求解器可能更适合。</strong><br>其实用法和 ode23 几乎一样,只是生成的数据图的数据点更密了.<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-5.png#align=left&display=inline&height=492&margin=%5Bobject%20Object%5D&originHeight=492&originWidth=612&size=0&status=done&style=none&width=612"></p>
<h1 id="刚性常微分方程"><a href="#刚性常微分方程" class="headerlink" title="刚性常微分方程"></a>刚性常微分方程</h1><h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><p>所谓刚性方程，就是说存在两(多)重尺度，一个尺度比另外一个尺度大很多。所导致的麻烦就是在计算中很难兼顾两者。例如下面的方程：dx=-100x-100.1ydy=100.1x-100y 两个特征值 lambda_1 = -200.1，lambda_2 = -0.1 所以解表现为 a1_exp(-200.1_X) + a2_exp(-0.1_X)，无论你用什么样的尺度(单一尺度)都不能很好刻画解的行为。一个是快变行为，一个是慢变行为。 所有这样的方程计算时候，稳定性条件比较苛刻。实际情况要比这还复杂得多。<br>对于刚性和非刚性微分方程的区分，可以简单的转变为在将原方程转换为常微分方程组后，进行一个简单的系数判断：<br>例如：</p>
<p>$$<br>y’’’ - 3y’’ - y’y = 0, y(0) = 0, y’(0) = 0, y’’(0) = -1;<br>$$</p>
<p>在这里可以设  y1 = y, y2 = y’, y3 = y’’, 有</p>
<p>$$<br>  y_1’ = y_2,      　y_1(0) = 0,<br>$$</p>
<p>$$<br>  y_2’ = y_3,       y_2(0) = 1,<br>$$</p>
<p>$$<br>  y_3’ = 3y_3 + y_2y_1,   y_3(0) = -1,<br>$$</p>
<p>这里可以简单判断出方程组的右侧系数矩阵值差异不大，得到的特征值差异随之也不大，可以简单判断为非刚性微分方程。<br>MATLAB 中<strong>解非刚性微分方程常用 ode45 ;</strong></p>
<p>又例如：<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-6.svg#card=math&code=y%27%27%20-%201000%281%20-%20y%5E2%29y%27%20%2B%20y%20%3D%200%2C%20y%280%29%20%3D%202%2C%20y%27%280%29%20%3D%200%3B&height=23&width=348"></p>
<p>在这里可以设<img src= "/img/loading.gif" data-lazy-src="https://cdn.nlark.com/yuque/__latex/0feecf5b95ff7b36da6886a607fb0ec6.svg#card=math&code=y1%20%3D%20y%2C%20y2%20%3D%20y%27&height=20&width=107">, 有</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-7.svg#card=math&code=y1%27%20%3D%20y2%2C%20%20%20%20%20%20%20%20%20%20%20y1%280%29%20%3D%202%2C&height=21&width=142"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-8.svg#card=math&code=y2%27%20%3D%201000%281%20-%20y1%5E2%29y2%20-%20y1%2C%20%20y2%280%29%20%3D%200%2C&height=23&width=280"></p>
<p>这里可以简单判断出方程组的右侧系数矩阵值差异较大，得到的特征值差异随之较大，可以简单判断为刚性微分方程。<br>MATLAB 中<strong>解刚性微分方程常用 ode15s , ode23s , ode23t , ode23tb ;</strong></p>
<blockquote>
<p>如果区分不出来就多试试.</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-9.png#align=left&display=inline&height=362&margin=%5Bobject%20Object%5D&originHeight=362&originWidth=704&size=0&status=done&style=none&width=704"></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">dy=@(t,y)[y(<span class="number">2</span>);y(<span class="number">3</span>);<span class="number">3</span>*y(<span class="number">3</span>)+y(<span class="number">2</span>)*y(<span class="number">1</span>)];</span><br><span class="line">[T,Y]=ode23s(@(t,y)dy(t,y),[<span class="number">0</span> <span class="number">1</span>],[<span class="number">0</span>;<span class="number">1</span>;<span class="number">-1</span>]);<span class="comment">%函数传参一定要声明句柄,参数前后都要写</span></span><br></pre></td></tr></table></figure>

<h1 id="解常微分方程符号解"><a href="#解常微分方程符号解" class="headerlink" title="解常微分方程符号解"></a>解常微分方程符号解</h1><p>常微分方程在 Matlab 中按如下规定重新表达： 符号 D 表示对变量的求导。Dy 表示对变量 y 求一阶导数，当需要求变量的 n 阶导 数时，用 Dn 表示，D4y 表示对变量 y 求 4 阶导数。由此，常微分方程 $y’’+2y’= y$ 在 Matlab 中，将写成<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-10.svg#card=math&code=D2y%2B2%2ADy%3Dy&height=18&width=128"></p>
<h2 id="求解常微分方程的通解"><a href="#求解常微分方程的通解" class="headerlink" title="求解常微分方程的通解"></a>求解常微分方程的通解</h2><p>无初边值条件的常微分方程的解就是该方程的通解。<br><code>dsolve(&#39; diff_equation&#39;，&#39;var&#39;)</code><br>式中 diff_equation 为待解的常微分方程，第 1 种格式将以变量 t 为自变量进行求解， 第 2 种格式则需定义自变量 var。<br>栗子:<br>解<img src= "/img/loading.gif" data-lazy-src="https://cdn.nlark.com/yuque/__latex/80ea40cf4ace3937d7e295680fe5eac1.svg#card=math&code=x%5E2%2By%2B%28x-2y%29y%27%3D0&height=23&width=171"><br>程序如下:</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">syms x y</span><br><span class="line">diff_equ=<span class="string">&#x27;x^2+y+(x-2*y)*Dy=0&#x27;</span>;<span class="comment">%字符串形式的变量!注意!</span></span><br><span class="line">dsolve(diff_equ,<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"><span class="comment">%ans =</span></span><br><span class="line"><span class="comment">% x/2 + ((4*x^3)/3 + x^2 + C4)^(1/2)/2</span></span><br><span class="line"><span class="comment">% x/2 - ((4*x^3)/3 + x^2 + C4)^(1/2)/2</span></span><br></pre></td></tr></table></figure>

<h2 id="求解常微分方程的初边值问题"><a href="#求解常微分方程的初边值问题" class="headerlink" title="求解常微分方程的初边值问题"></a>求解常微分方程的初边值问题</h2><p><code>dsolve(&#39;diff_equation&#39;，&#39;condition1，condition2，…&#39;，&#39;var&#39;)</code>其中 condition1，condition2，… 即为微分方程的初边值条件。<br>例如<code>y=dsolve(&#39;D3y-D2y=x&#39;,&#39;y(1)=8,Dy(1)=7,D2y(2)=4&#39;,&#39;x&#39;)</code><br>结果为</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">y =</span><br><span class="line">x*((<span class="built_in">exp</span>(<span class="number">-1</span>)*(<span class="number">19</span>*<span class="built_in">exp</span>(<span class="number">1</span>) - <span class="number">14</span>))/<span class="number">2</span> - <span class="number">1</span>) + <span class="number">7</span>*<span class="built_in">exp</span>(<span class="number">-2</span>)*<span class="built_in">exp</span>(x) - x^<span class="number">2</span>/<span class="number">2</span> - x^<span class="number">3</span>/<span class="number">6</span> + (<span class="built_in">exp</span>(<span class="number">-1</span>)*(<span class="number">19</span>*<span class="built_in">exp</span>(<span class="number">1</span>) - <span class="number">14</span>))/<span class="number">2</span> - (<span class="built_in">exp</span>(<span class="number">-1</span>)*(<span class="number">25</span>*<span class="built_in">exp</span>(<span class="number">1</span>) - <span class="number">21</span>))/<span class="number">3</span> - <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="求解常微分方程组"><a href="#求解常微分方程组" class="headerlink" title="求解常微分方程组"></a>求解常微分方程组</h2><p><code> ``dsolve``(``&#39;diff_equ1，diff_equ2，…&#39;``，``&#39;``var``&#39;``)``%用于求通解</code><br><code> ``dsolve``(``&#39;diff_equ1，diff_equ2，…&#39;``，``&#39;``condition1，condition2，…``&#39;``，``&#39;``var``&#39;``)``%用于求初始值</code><br>例如,求<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-11.svg#card=math&code=%5Cleft%5C%7B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Brcl%7D%0A%20%20%20%20f%27%27%2B3g%3Dsinx%5C%5C%0A%20%20%20%20f%27%2Bg%27%3Dcosx%0A%20%20%20%20%20%20%20%0A%20%20%20%20%5Cend%7Barray%7D%0A%20%20%20%0A%5Cright.&height=45&width=128"></p>
<p>这个方程组的通解和在初始值为的解.</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">equ1=<span class="string">&#x27;D2f+3*g=sin(x)&#x27;</span>;</span><br><span class="line">equ2=<span class="string">&#x27;Dg+Df=cos(x)&#x27;</span>;</span><br><span class="line">[general_f,general_g]=dsolve(equ1,equ2,<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">[f,g]=dsolve(equ1,equ2,<span class="string">&#x27;Df(2)=0,f(3)=3,g(5)=1&#x27;</span>,<span class="string">&#x27;x&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>目前没有覆盖到多变量的常微分方程数值解,也不知道 ode45 传初始值的矩阵究竟用列向量还是行向量(似乎都可以,无论逗号或是分号)</p>
<h1 id="实战学习"><a href="#实战学习" class="headerlink" title="实战学习"></a>实战学习</h1><h2 id="双变量初始值下的常微分方程组"><a href="#双变量初始值下的常微分方程组" class="headerlink" title="双变量初始值下的常微分方程组"></a>双变量初始值下的常微分方程组</h2><h3 id="伏尔泰拉-Volterra-弱肉强食模型"><a href="#伏尔泰拉-Volterra-弱肉强食模型" class="headerlink" title="伏尔泰拉(Volterra)弱肉强食模型"></a>伏尔泰拉(Volterra)弱肉强食模型</h3><h4 id="问题提出"><a href="#问题提出" class="headerlink" title="问题提出"></a>问题提出</h4><p><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-12.png#align=left&display=inline&height=551&margin=%5Bobject%20Object%5D&originHeight=551&originWidth=1210&size=0&status=done&style=none&width=1210"></p>
<h4 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h4><p>即初值问题</p>
<p>其中,</p>
<ul>
<li><p>r 是食饵独立生存的时候自然增长率</p>
</li>
<li><p>a 是由于捕食者存在导致减少的比例系数</p>
</li>
<li><p>c 是捕食者独自存在时候的死亡率</p>
</li>
<li><p>b 是由于食饵存在导致死亡率减少的比例系数</p>
</li>
</ul>
<blockquote>
<p>它们均大于 0.</p>
</blockquote>
<p>注意多变量的矩阵变换<br>或许必须将 x’,y’放在方程组的一边用于迭代<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-13.png#align=left&display=inline&height=1000&margin=%5Bobject%20Object%5D&originHeight=1000&originWidth=1743&size=0&status=done&style=none&width=1743"><br>但是如果 x’与 y’是乘的关系呢?<br>似乎不用考虑,因为高数里面也没有涉及到<br>函数文件</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dd</span> = <span class="title">shier</span><span class="params">(t,x)</span></span></span><br><span class="line">r = <span class="number">1</span>;</span><br><span class="line">c =<span class="number">0.5</span>;</span><br><span class="line">a = <span class="number">0.1</span>;</span><br><span class="line">b = <span class="number">0.02</span>;</span><br><span class="line">dd = <span class="built_in">diag</span>([r-a*x(<span class="number">2</span>,:),-c+b*x(<span class="number">1</span>,:)])*x;<span class="comment">%把原来的x,y放在一个矩阵里就可以只用一个符号变量进行索引</span></span><br><span class="line"><span class="comment">%对于左边是x&#x27;的,就把x初始值乘进去,然后索引y的初始值,其实如果反过来索引也可以</span></span><br><span class="line">dd返回的是[x&#x27;,y&#x27;]&#x27;,然后交给ode45处理</span><br></pre></td></tr></table></figure>

<p>调用文件</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">tspan = <span class="number">0</span>:<span class="number">0.1</span>:<span class="number">15</span>;</span><br><span class="line">[t,x] = ode45(@shier,tspan,[<span class="number">25</span>;<span class="number">2</span>]);<span class="comment">%我认为t只是传进来迭代次数,与常微分方程组本身并无关系</span></span><br><span class="line"><span class="built_in">plot</span>(t,x);</span><br></pre></td></tr></table></figure>

<p>结果<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-14.png#align=left&display=inline&height=484&margin=%5Bobject%20Object%5D&originHeight=484&originWidth=631&size=0&status=done&style=none&width=631"><br>这里甚至可以看出图像具有周期性,那么怎么计算出周期呢?</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">tspan = <span class="number">0</span>:<span class="number">0.1</span>:<span class="number">15</span>;</span><br><span class="line">[t,x] = ode45(@shier,tspan,[<span class="number">25</span>;<span class="number">2</span>]);<span class="comment">%我认为t只是传进来迭代次数,与常微分方程组本身并无关系</span></span><br><span class="line"><span class="comment">%方法一</span></span><br><span class="line"><span class="comment">%a = find((abs(x(1,1)-x(1:length(x),1)))&lt;1);%如果是min的话他只会索引到第一个原值</span></span><br><span class="line">这里</span><br><span class="line"><span class="comment">%方法二</span></span><br><span class="line">a = <span class="built_in">find</span>(x(:,<span class="number">1</span>)==(x(<span class="number">1</span>,<span class="number">1</span>)-<span class="built_in">min</span>(<span class="built_in">abs</span>((x(<span class="number">1</span>,<span class="number">1</span>)-x(<span class="number">2</span>:<span class="built_in">length</span>(x),<span class="number">1</span>))))));<span class="comment">%这里不是加就是减,一定会索引到最小值的,多试两遍就出来了</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="comment">%plot(t,x,t(a(2,1),1),x(a(2,1),1),&#x27;*&#x27;);%方法一对应的找数据点方法</span></span><br><span class="line"><span class="built_in">plot</span>(t,x,t(a,<span class="number">1</span>),x(a,<span class="number">1</span>),<span class="string">&#x27;*&#x27;</span>);<span class="comment">%方法二对应的找数据点的方法</span></span><br><span class="line"><span class="built_in">hold</span> on;</span><br><span class="line">line([<span class="number">0</span> <span class="number">15</span>],[x(a,<span class="number">1</span>) x(a,<span class="number">1</span>)],<span class="string">&#x27;LineStyle&#x27;</span>,<span class="string">&#x27;--&#x27;</span>);<span class="comment">%画一条水平线</span></span><br><span class="line">line([t(a,<span class="number">1</span>) t(a,<span class="number">1</span>)],[<span class="number">0</span> x(a,<span class="number">1</span>)],<span class="string">&#x27;LineStyle&#x27;</span>,<span class="string">&#x27;--&#x27;</span>);<span class="comment">%画一条竖直线</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">plot</span>(x(:,<span class="number">1</span>),x(:,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<p>效果图<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-15.png#align=left&display=inline&height=478&margin=%5Bobject%20Object%5D&originHeight=478&originWidth=627&size=0&status=done&style=none&width=627"><br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-16.png#align=left&display=inline&height=481&margin=%5Bobject%20Object%5D&originHeight=481&originWidth=610&size=0&status=done&style=none&width=610"><br>其中 dd 参数在传入初始值[25;2]后运算结果(即 t=0.1 时)</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line"> <span class="number">25</span>*r - <span class="number">25</span>*a*y</span><br><span class="line"> <span class="number">2</span>*b*x - <span class="number">2</span>*c</span><br><span class="line"> <span class="comment">%这是一个列向量,有两行,其中y为2,x为25,这里只是为了便于理解</span></span><br></pre></td></tr></table></figure>

<pre><code>  而结果最终返回的x是一个n*2的矩阵,第一列是x,第二列是y</code></pre>
<p>结果的数值表示为</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ans</span> =</span><br><span class="line"></span><br><span class="line">                   <span class="number">0</span>  <span class="number">25.000000000000000</span>   <span class="number">2.000000000000000</span></span><br><span class="line">   <span class="number">0.100000000000000</span>  <span class="number">27.081808053754724</span>   <span class="number">2.004112695948303</span></span><br><span class="line">   <span class="number">0.200000000000000</span>  <span class="number">29.334409623386446</span>   <span class="number">2.016970388233990</span></span><br><span class="line">   <span class="number">0.300000000000000</span>  <span class="number">31.768915238930827</span>   <span class="number">2.039429632085728</span></span><br><span class="line">   <span class="number">0.400000000000000</span>  <span class="number">34.396069793378309</span>   <span class="number">2.072575255691516</span></span><br><span class="line">   <span class="number">0.500000000000000</span>  <span class="number">37.225819482896881</span>   <span class="number">2.117788767225540</span></span><br><span class="line">   <span class="number">0.600000000000000</span>  <span class="number">40.267311806832083</span>   <span class="number">2.176748354848179</span></span><br><span class="line">   <span class="number">0.700000000000000</span>  <span class="number">43.501170756497132</span>   <span class="number">2.253434244955612</span></span><br><span class="line">   <span class="number">0.800000000000000</span>  <span class="number">46.935996455891825</span>   <span class="number">2.350284334323296</span></span><br><span class="line">   <span class="number">0.900000000000000</span>  <span class="number">50.607214111441841</span>   <span class="number">2.468336939929975</span></span><br><span class="line">   <span class="number">1.000000000000000</span>  <span class="number">54.530132303795753</span>   <span class="number">2.610565196434151</span></span><br><span class="line">   <span class="number">1.100000000000000</span>  <span class="number">58.699942987824969</span>   <span class="number">2.781877056174068</span></span><br><span class="line">   <span class="number">1.200000000000000</span>  <span class="number">63.091721492623776</span>   <span class="number">2.989115289167727</span></span><br><span class="line">   <span class="number">1.300000000000000</span>  <span class="number">67.660426521509294</span>   <span class="number">3.241057483112876</span></span><br><span class="line">   <span class="number">1.400000000000000</span>  <span class="number">72.340900152021618</span>   <span class="number">3.548416043387018</span></span><br><span class="line">   <span class="number">1.500000000000000</span>  <span class="number">77.047867835923512</span>   <span class="number">3.923838193047399</span></span><br><span class="line">   <span class="number">1.600000000000000</span>  <span class="number">81.675938399200817</span>   <span class="number">4.381905972831026</span></span><br><span class="line">   <span class="number">1.700000000000000</span>  <span class="number">86.099604042062211</span>   <span class="number">4.939136241154664</span></span><br><span class="line">   <span class="number">1.800000000000000</span>  <span class="number">90.173240338938967</span>   <span class="number">5.613980674114787</span></span><br><span class="line">   <span class="number">1.900000000000000</span>  <span class="number">93.731106238485580</span>   <span class="number">6.426825765487674</span></span><br><span class="line">   <span class="number">2.000000000000000</span>  <span class="number">96.587344063579224</span>   <span class="number">7.399992826729324</span></span><br><span class="line">   <span class="number">2.100000000000000</span>  <span class="number">98.535979511319994</span>   <span class="number">8.557737986975489</span></span><br><span class="line">   <span class="number">2.200000000000000</span>  <span class="number">99.305464073021838</span>   <span class="number">9.923384989608529</span></span><br><span class="line">   <span class="number">2.300000000000000</span>  <span class="number">98.614325538390403</span>  <span class="number">11.508508167056767</span></span><br><span class="line">   <span class="number">2.400000000000000</span>  <span class="number">96.285088095021379</span>  <span class="number">13.306709884287148</span></span><br><span class="line">   <span class="number">2.500000000000000</span>  <span class="number">92.247162361659704</span>  <span class="number">15.288207079976694</span></span><br><span class="line">   <span class="number">2.600000000000000</span>  <span class="number">86.585268003842529</span>  <span class="number">17.394730789385640</span></span><br><span class="line">   <span class="number">2.700000000000000</span>  <span class="number">79.534876888241484</span>  <span class="number">19.542682224883006</span></span><br><span class="line">   <span class="number">2.800000000000000</span>  <span class="number">71.536355306602971</span>  <span class="number">21.622546215392298</span></span><br><span class="line">   <span class="number">2.900000000000000</span>  <span class="number">63.084804160958107</span>  <span class="number">23.530018889724300</span></span><br><span class="line">   <span class="number">3.000000000000000</span>  <span class="number">54.623560359426598</span>  <span class="number">25.181931216068016</span></span><br><span class="line">   <span class="number">3.100000000000000</span>  <span class="number">46.544096804423660</span>  <span class="number">26.516262459375845</span></span><br><span class="line">   <span class="number">3.200000000000000</span>  <span class="number">39.186022392660291</span>  <span class="number">27.492140181363510</span></span><br><span class="line">   <span class="number">3.300000000000000</span>  <span class="number">32.793221206846198</span>  <span class="number">28.097843791494348</span></span><br><span class="line">   <span class="number">3.400000000000000</span>  <span class="number">27.336823355775415</span>  <span class="number">28.376560995050070</span></span><br><span class="line">   <span class="number">3.500000000000000</span>  <span class="number">22.737483650943837</span>  <span class="number">28.376423948829007</span></span><br><span class="line">   <span class="number">3.600000000000000</span>  <span class="number">18.913395131038023</span>  <span class="number">28.142567798641700</span></span><br><span class="line">   <span class="number">3.700000000000000</span>  <span class="number">15.777073834688206</span>  <span class="number">27.717805173699979</span></span><br><span class="line">   <span class="number">3.800000000000000</span>  <span class="number">13.235358800468109</span>  <span class="number">27.142626186616940</span></span><br><span class="line">   <span class="number">3.900000000000000</span>  <span class="number">11.187311576411814</span>  <span class="number">26.455624312391883</span></span><br><span class="line">   <span class="number">4.000000000000000</span>   <span class="number">9.527792494902240</span>  <span class="number">25.691072088430193</span></span><br><span class="line">   <span class="number">4.100000000000001</span>   <span class="number">8.175847419742645</span>  <span class="number">24.874012401250678</span></span><br><span class="line">   <span class="number">4.200000000000000</span>   <span class="number">7.068391701914113</span>  <span class="number">24.024511571721689</span></span><br><span class="line">   <span class="number">4.300000000000000</span>   <span class="number">6.159197028246341</span>  <span class="number">23.157992057962328</span></span><br><span class="line">   <span class="number">4.400000000000000</span>   <span class="number">5.418516351184799</span>  <span class="number">22.285300010011660</span></span><br><span class="line">   <span class="number">4.500000000000000</span>   <span class="number">4.812949938211244</span>  <span class="number">21.416178920107392</span></span><br><span class="line">   <span class="number">4.600000000000001</span>   <span class="number">4.312378013540997</span>  <span class="number">20.558183397698095</span></span><br><span class="line">   <span class="number">4.700000000000000</span>   <span class="number">3.896728033888424</span>  <span class="number">19.716433768708011</span></span><br><span class="line">   <span class="number">4.800000000000001</span>   <span class="number">3.549963138651240</span>  <span class="number">18.894836312980246</span></span><br><span class="line">   <span class="number">4.900000000000000</span>   <span class="number">3.260082149910534</span>  <span class="number">18.096083264276789</span></span><br><span class="line">   <span class="number">5.000000000000000</span>   <span class="number">3.018079494247696</span>  <span class="number">17.321894302742177</span></span><br><span class="line">   <span class="number">5.100000000000001</span>   <span class="number">2.815390957478957</span>  <span class="number">16.573545734604863</span></span><br><span class="line">   <span class="number">5.200000000000000</span>   <span class="number">2.645975745866385</span>  <span class="number">15.851549329681150</span></span><br><span class="line">   <span class="number">5.300000000000001</span>   <span class="number">2.504682806034744</span>  <span class="number">15.156183855662157</span></span><br><span class="line">   <span class="number">5.400000000000000</span>   <span class="number">2.387154825623396</span>  <span class="number">14.487520111000972</span></span><br><span class="line">   <span class="number">5.500000000000000</span>   <span class="number">2.289828233286297</span>  <span class="number">13.845420924912609</span></span><br><span class="line">   <span class="number">5.600000000000001</span>   <span class="number">2.209933198691999</span>  <span class="number">13.229541157374021</span></span><br><span class="line">   <span class="number">5.700000000000000</span>   <span class="number">2.145493632523649</span>  <span class="number">12.639327699124115</span></span><br><span class="line">   <span class="number">5.800000000000001</span>   <span class="number">2.095302528876663</span>  <span class="number">12.074025260038512</span></span><br><span class="line">   <span class="number">5.900000000000000</span>   <span class="number">2.057819970371494</span>  <span class="number">11.532952029583695</span></span><br><span class="line">   <span class="number">6.000000000000000</span>   <span class="number">2.031734456202639</span>  <span class="number">11.015418711177421</span></span><br><span class="line">   <span class="number">6.100000000000001</span>   <span class="number">2.016223775353870</span>  <span class="number">10.520656535937128</span></span><br><span class="line">   <span class="number">6.200000000000000</span>   <span class="number">2.010602361556739</span>  <span class="number">10.047895063292874</span></span><br><span class="line">   <span class="number">6.300000000000001</span>   <span class="number">2.014321293290578</span>   <span class="number">9.596362180987299</span></span><br><span class="line">   <span class="number">6.400000000000000</span>   <span class="number">2.026968293782502</span>   <span class="number">9.165284105075676</span></span><br><span class="line">   <span class="number">6.500000000000000</span>   <span class="number">2.048267731007400</span>   <span class="number">8.753885379925855</span></span><br><span class="line">   <span class="number">6.600000000000001</span>   <span class="number">2.078080617687949</span>   <span class="number">8.361388878218298</span></span><br><span class="line">   <span class="number">6.700000000000000</span>   <span class="number">2.116388457892334</span>   <span class="number">7.987017842929896</span></span><br><span class="line">   <span class="number">6.800000000000001</span>   <span class="number">2.163225001305634</span>   <span class="number">7.630030231078177</span></span><br><span class="line">   <span class="number">6.900000000000000</span>   <span class="number">2.218783549199125</span>   <span class="number">7.289725741835887</span></span><br><span class="line">   <span class="number">7.000000000000000</span>   <span class="number">2.283347851980680</span>   <span class="number">6.965426060221426</span></span><br><span class="line">   <span class="number">7.100000000000001</span>   <span class="number">2.357279290720927</span>   <span class="number">6.656474302505986</span></span><br><span class="line">   <span class="number">7.200000000000000</span>   <span class="number">2.441016877153240</span>   <span class="number">6.362235016213561</span></span><br><span class="line">   <span class="number">7.300000000000001</span>   <span class="number">2.535077253673752</span>   <span class="number">6.082094180120929</span></span><br><span class="line">   <span class="number">7.400000000000000</span>   <span class="number">2.640054693341341</span>   <span class="number">5.815459204257671</span></span><br><span class="line">   <span class="number">7.500000000000000</span>   <span class="number">2.756621099877643</span>   <span class="number">5.561758929906152</span></span><br><span class="line">   <span class="number">7.600000000000000</span>   <span class="number">2.885526007667043</span>   <span class="number">5.320443629601537</span></span><br><span class="line">   <span class="number">7.699999999999999</span>   <span class="number">3.027596581756677</span>   <span class="number">5.090985007131783</span></span><br><span class="line">   <span class="number">7.800000000000000</span>   <span class="number">3.183737617856438</span>   <span class="number">4.872876197537634</span></span><br><span class="line">   <span class="number">7.899999999999999</span>   <span class="number">3.354931542338962</span>   <span class="number">4.665631767112639</span></span><br><span class="line">   <span class="number">8.000000000000000</span>   <span class="number">3.542377769952171</span>   <span class="number">4.468790794779848</span></span><br><span class="line">   <span class="number">8.100000000000000</span>   <span class="number">3.747750865739365</span>   <span class="number">4.281929919898753</span></span><br><span class="line">   <span class="number">8.199999999999999</span>   <span class="number">3.972287358592226</span>   <span class="number">4.104642734922401</span></span><br><span class="line">   <span class="number">8.300000000000001</span>   <span class="number">4.217388158593900</span>   <span class="number">3.936541934626040</span></span><br><span class="line">   <span class="number">8.399999999999999</span>   <span class="number">4.484692559397574</span>   <span class="number">3.777260394101559</span></span><br><span class="line">   <span class="number">8.500000000000000</span>   <span class="number">4.776078238226527</span>   <span class="number">3.626451168757456</span></span><br><span class="line">   <span class="number">8.600000000000000</span>   <span class="number">5.093661255874061</span>   <span class="number">3.483787494318877</span></span><br><span class="line">   <span class="number">8.699999999999999</span>   <span class="number">5.439796056703555</span>   <span class="number">3.348962786827587</span></span><br><span class="line">   <span class="number">8.800000000000001</span>   <span class="number">5.817075468648450</span>   <span class="number">3.221690642641979</span></span><br><span class="line">   <span class="number">8.899999999999999</span>   <span class="number">6.228330703212222</span>   <span class="number">3.101704838437082</span></span><br><span class="line">   <span class="number">9.000000000000000</span>   <span class="number">6.676631355468448</span>   <span class="number">2.988759331204541</span></span><br><span class="line">   <span class="number">9.100000000000000</span>   <span class="number">7.165285404060722</span>   <span class="number">2.882628258252642</span></span><br><span class="line">   <span class="number">9.199999999999999</span>   <span class="number">7.697839211202703</span>   <span class="number">2.783105937206295</span></span><br><span class="line">   <span class="number">9.300000000000001</span>   <span class="number">8.278077522678160</span>   <span class="number">2.690006866007034</span></span><br><span class="line">   <span class="number">9.399999999999999</span>   <span class="number">8.910023467840816</span>   <span class="number">2.603165722913034</span></span><br><span class="line">   <span class="number">9.500000000000000</span>   <span class="number">9.597978929632328</span>   <span class="number">2.522479626174848</span></span><br><span class="line">   <span class="number">9.600000000000000</span>  <span class="number">10.346846934533836</span>   <span class="number">2.447948500050266</span></span><br><span class="line">   <span class="number">9.699999999999999</span>  <span class="number">11.162039893459859</span>   <span class="number">2.379385045866726</span></span><br><span class="line">   <span class="number">9.800000000000001</span>  <span class="number">12.049420139992524</span>   <span class="number">2.316643469274441</span></span><br><span class="line">   <span class="number">9.899999999999999</span>  <span class="number">13.015307238019034</span>   <span class="number">2.259644421438928</span></span><br><span class="line">  <span class="number">10.000000000000000</span>  <span class="number">14.066477981731850</span>   <span class="number">2.208374999040992</span></span><br><span class="line">  <span class="number">10.100000000000000</span>  <span class="number">15.210166395628448</span>   <span class="number">2.162888744276744</span></span><br><span class="line">  <span class="number">10.199999999999999</span>  <span class="number">16.454063734511507</span>   <span class="number">2.123305644857589</span></span><br><span class="line">  <span class="number">10.300000000000001</span>  <span class="number">17.806318483488852</span>   <span class="number">2.089812134010228</span></span><br><span class="line">  <span class="number">10.399999999999999</span>  <span class="number">19.275536357973380</span>   <span class="number">2.062661090476664</span></span><br><span class="line">  <span class="number">10.500000000000000</span>  <span class="number">20.870780303683247</span>   <span class="number">2.042171838514192</span></span><br><span class="line">  <span class="number">10.600000000000000</span>  <span class="number">22.601570496641628</span>   <span class="number">2.028730147895408</span></span><br><span class="line">  <span class="number">10.699999999999999</span>  <span class="number">24.477884343176854</span>   <span class="number">2.022788233908206</span></span><br><span class="line">  <span class="number">10.800000000000001</span>  <span class="number">26.510156479922557</span>   <span class="number">2.024864757355776</span></span><br><span class="line">  <span class="number">10.899999999999999</span>  <span class="number">28.709278773817164</span>   <span class="number">2.035544824556605</span></span><br><span class="line">  <span class="number">11.000000000000000</span>  <span class="number">31.084367983721659</span>   <span class="number">2.055829025420224</span></span><br><span class="line">  <span class="number">11.100000000000000</span>  <span class="number">33.641600133885817</span>   <span class="number">2.087482853795129</span></span><br><span class="line">  <span class="number">11.199999999999999</span>  <span class="number">36.398209815499314</span>   <span class="number">2.130849364961110</span></span><br><span class="line">  <span class="number">11.300000000000001</span>  <span class="number">39.367967703938106</span>   <span class="number">2.186873814289113</span></span><br><span class="line">  <span class="number">11.400000000000000</span>  <span class="number">42.559757627422172</span>   <span class="number">2.257313701026955</span></span><br><span class="line">  <span class="number">11.500000000000000</span>  <span class="number">45.977576567015859</span>   <span class="number">2.344738768299329</span></span><br><span class="line">  <span class="number">11.600000000000000</span>  <span class="number">49.620534656627697</span>   <span class="number">2.452531003107799</span></span><br><span class="line">  <span class="number">11.699999999999999</span>  <span class="number">53.482855183010443</span>   <span class="number">2.584884636330803</span></span><br><span class="line">  <span class="number">11.800000000000001</span>  <span class="number">57.553874585761008</span>   <span class="number">2.746806142723651</span></span><br><span class="line">  <span class="number">11.900000000000000</span>  <span class="number">61.818042457320516</span>   <span class="number">2.944114240918524</span></span><br><span class="line">  <span class="number">12.000000000000000</span>  <span class="number">66.254921542974230</span>   <span class="number">3.183439893424474</span></span><br><span class="line">  <span class="number">12.100000000000000</span>  <span class="number">70.842835987138443</span>   <span class="number">3.469191596026587</span></span><br><span class="line">  <span class="number">12.199999999999999</span>  <span class="number">75.522162277682469</span>   <span class="number">3.812925452239469</span></span><br><span class="line">  <span class="number">12.300000000000001</span>  <span class="number">80.190042341363892</span>   <span class="number">4.234758224058336</span></span><br><span class="line">  <span class="number">12.400000000000000</span>  <span class="number">84.721311371072218</span>   <span class="number">4.754536876029922</span></span><br><span class="line">  <span class="number">12.500000000000000</span>  <span class="number">88.968565157515215</span>   <span class="number">5.391807215404708</span></span><br><span class="line">  <span class="number">12.600000000000000</span>  <span class="number">92.762160089218654</span>   <span class="number">6.165813892136889</span></span><br><span class="line">  <span class="number">12.699999999999999</span>  <span class="number">95.910213152526353</span>   <span class="number">7.095500398884376</span></span><br><span class="line">  <span class="number">12.800000000000001</span>  <span class="number">98.198601931600223</span>   <span class="number">8.199509071008816</span></span><br><span class="line">  <span class="number">12.900000000000000</span>  <span class="number">99.390964608420120</span>   <span class="number">9.496181086575533</span></span><br><span class="line">  <span class="number">13.000000000000000</span>  <span class="number">99.228699962784120</span>  <span class="number">11.003556466353615</span></span><br><span class="line">  <span class="number">13.100000000000000</span>  <span class="number">97.436046146590030</span>  <span class="number">12.738369650117397</span></span><br><span class="line">  <span class="number">13.199999999999999</span>  <span class="number">93.897248393422203</span>  <span class="number">14.679124234884609</span></span><br><span class="line">  <span class="number">13.300000000000001</span>  <span class="number">88.688453695875353</span>  <span class="number">16.763830256803850</span></span><br><span class="line">  <span class="number">13.400000000000000</span>  <span class="number">82.012934272797054</span>  <span class="number">18.915104969188761</span></span><br><span class="line">  <span class="number">13.500000000000000</span>  <span class="number">74.220377956306322</span>  <span class="number">21.037723489086446</span></span><br><span class="line">  <span class="number">13.600000000000000</span>  <span class="number">65.797111775025812</span>  <span class="number">23.020131785390436</span></span><br><span class="line">  <span class="number">13.699999999999999</span>  <span class="number">57.253976641417438</span>  <span class="number">24.761724756250914</span></span><br><span class="line">  <span class="number">13.800000000000001</span>  <span class="number">49.023767724601868</span>  <span class="number">26.194780217083739</span></span><br><span class="line">  <span class="number">13.900000000000000</span>  <span class="number">41.434244003664332</span>  <span class="number">27.279068723563903</span></span><br><span class="line">  <span class="number">14.000000000000000</span>  <span class="number">34.706174448093314</span>  <span class="number">28.001620983792861</span></span><br><span class="line">  <span class="number">14.100000000000000</span>  <span class="number">28.935101031065749</span>  <span class="number">28.380190468466417</span></span><br><span class="line">  <span class="number">14.199999999999999</span>  <span class="number">24.065998570034740</span>  <span class="number">28.461020682665570</span></span><br><span class="line">  <span class="number">14.300000000000001</span>  <span class="number">20.010527449455722</span>  <span class="number">28.291941938864412</span></span><br><span class="line">  <span class="number">14.400000000000000</span>  <span class="number">16.675929778091504</span>  <span class="number">27.918123986722730</span></span><br><span class="line">  <span class="number">14.500000000000000</span>  <span class="number">13.965024013772720</span>  <span class="number">27.382080322488665</span></span><br><span class="line">  <span class="number">14.600000000000000</span>  <span class="number">11.774235192175343</span>  <span class="number">26.723934672852753</span></span><br><span class="line">  <span class="number">14.699999999999999</span>   <span class="number">9.998177418711006</span>  <span class="number">25.978837203372350</span></span><br><span class="line">  <span class="number">14.800000000000001</span>   <span class="number">8.554008385420849</span>  <span class="number">25.173646553167053</span></span><br><span class="line">  <span class="number">14.900000000000000</span>   <span class="number">7.376179856212027</span>  <span class="number">24.330003419116061</span></span><br><span class="line">  <span class="number">15.000000000000000</span>   <span class="number">6.415769580325549</span>  <span class="number">23.464512074444599</span></span><br></pre></td></tr></table></figure>

<h2 id="火箭升空模型"><a href="#火箭升空模型" class="headerlink" title="火箭升空模型"></a>火箭升空模型</h2><p>火箭模型复现之后发现与课本数据有少许误差,我认为是 matlab 版本以及计算精度造成的差异<br><img src= "/img/loading.gif" data-lazy-src="https://image.hackerjerry.top/Differential-Equations-17.png#align=left&display=inline&height=766&margin=%5Bobject%20Object%5D&originHeight=766&originWidth=850&size=0&status=done&style=none&width=850"></p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ts1 = <span class="number">0</span>:<span class="number">0.1</span>:<span class="number">60</span>;</span><br><span class="line">ts2 = <span class="number">60</span>:<span class="number">0.1</span>:<span class="number">71.5</span>;</span><br><span class="line">[t1,x1] = ode45(@(t,y)huojian1(t,y),ts1,[<span class="number">0</span>,<span class="number">0</span>]);<span class="comment">%第一阶段</span></span><br><span class="line">[t2,x2] = ode45(@(t,y)huojian2(t,y),ts2,[x1(<span class="built_in">length</span>(x1),<span class="number">1</span>),x1(<span class="built_in">length</span>(x1),<span class="number">2</span>)]);<span class="comment">%第二阶段</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">plot</span>(t1,x1(:,<span class="number">1</span>),t2,x2(:,<span class="number">1</span>));<span class="comment">%速度图</span></span><br><span class="line"><span class="comment">%[t2,x2] = ode45(@huojian2,t2,[0 0]);</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line"><span class="comment">%画高度图</span></span><br><span class="line"><span class="built_in">plot</span>(t1,x1(:,<span class="number">2</span>),t2,x2(:,<span class="number">2</span>));</span><br><span class="line"><span class="comment">%画加速度图</span></span><br><span class="line">a1 =diff(x1(:,<span class="number">1</span>));</span><br><span class="line">s1 = <span class="built_in">linspace</span>(<span class="number">0</span>,<span class="number">60</span>,<span class="number">600</span>)&#x27;;<span class="comment">%由于前向差分的缘故数据点与横坐标差了1,因此做一个数据拟合</span></span><br><span class="line">s2 = <span class="built_in">linspace</span>(<span class="number">60</span>,<span class="number">71.5</span>,<span class="number">115</span>)&#x27;;</span><br><span class="line">a11 = spline(s1,a1,t1);</span><br><span class="line">a2 = diff(x2(:,<span class="number">1</span>));</span><br><span class="line">a22 = spline(s2,a2,t2);</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">plot</span>(t1,a11,t2,a22);grid on;</span><br><span class="line">两阶段微分方程组</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span> = <span class="title">huojian1</span><span class="params">(t,x)</span></span></span><br><span class="line"><span class="comment">%阶段一</span></span><br><span class="line">M = <span class="number">1400</span>;m = <span class="number">18</span>;F = <span class="number">32000</span>;k = <span class="number">0.4</span>;g = <span class="number">9.8</span>;</span><br><span class="line">dx = [(F-k*x(<span class="number">1</span>,<span class="number">1</span>)*x(<span class="number">1</span>,<span class="number">1</span>))/(M-m*t)-g;x(<span class="number">1</span>,<span class="number">1</span>)];</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dx</span> =<span class="title">huojian2</span><span class="params">(t,x)</span></span></span><br><span class="line"><span class="comment">%阶段二</span></span><br><span class="line">k = <span class="number">0.4</span>;g = <span class="number">9.8</span>;M0=<span class="number">320</span>;</span><br><span class="line">dx = [(-k*x(<span class="number">1</span>)*x(<span class="number">1</span>))/M0-g;x(<span class="number">1</span>)];</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29831163/article/details/89702947">相关 Blog</a><br>参考网址:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_29831163/article/details/89703911">https://blog.csdn.net/qq_29831163/article/details/89703911</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">M@tr1x</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.blog.hackerjerry.top/2020/09/10/Differential-Equations_new/">https://www.blog.hackerjerry.top/2020/09/10/Differential-Equations_new/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.blog.hackerjerry.top" target="_blank">M@tr1xの日常</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/">微分方程</a></div><div class="post_share"><div class="social-share" data-image="https://image.hackerjerry.top/wallpaper-8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/09/14/Unconstrained-Optimization_new/"><img class="prev-cover" data-lazy-src="https://image.hackerjerry.top/wallpaper-7.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Unconstrained-Optimization</div></div></a></div><div class="next-post pull-right"><a href="/2020/09/10/Solving-Nonlinear-equations-and-equations_new/"><img class="next-cover" data-lazy-src="https://image.hackerjerry.top/wallpaper-11.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Solving-Nonlinear-equations-and-equations</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By M@tr1x</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">冷風熱血，荡涤乾坤</div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>陕ICP备19023179号</span></a></div><div class="cdn"><a href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" target="_blank"><img src="/img/upyun.png" width="70px"/><span></span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    window.valine = new Valine({
      el: '#vcomment',
      appId: 'jApqS8Xxcc1eST53AyiAisFx-gzGzoHsz',
      appKey: 'iyngroaUslATD8V4nOgOHowr',
      placeholder: '说点什么呗~',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
    });
    if ('nick,mail') { valine.config.requiredFields= 'nick,mail'.split(',') }
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>